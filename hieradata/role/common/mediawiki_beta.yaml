users::groups:
  - mediawiki-admins
  - mediawiki-roots
  - mediawiki-test-admins

contactgroups: ['infra', 'mediawiki']

base::dns::do_ipv4: true
base::dns::do_ipv6: false
base::dns::forward_use_internal: true

jobrunner: true
jobrunner::intensive: true

mediawiki::jobqueue::runner::periodic_jobs: true
mediawiki::jobqueue::runner::redis_ip: '10.0.15.118:6379'
mediawiki::jobqueue::wiki: 'loginwikibeta'
mediawiki::use_cpjobqueue: false

role::mediawiki::use_strict_firewall: true
role::mediawiki::is_beta: true

nginx::config:
  # This is the equivelent of Timeout in apache
  client_header_timeout: 202s
  client_body_timeout: 202s
  send_timeout: 202s
  # Matches apache ProxyTimeout default
  proxy_connect_timeout: 300s
  proxy_send_timeout:    300s
  proxy_read_timeout:    300s

mediawiki::php::request_timeout: 201
mediawiki::php::fpm::fpm_workers_multiplier: 2.0
mediawiki::php::fpm_config:
  post_max_size: '250M'
  upload_max_filesize: '250M'
  max_execution_time: 210

# Temporarily false until we build xhprof on PHP 8.4
mediawiki::php::enable_request_profiling: false

mediawiki::use_staging: true
mediawiki::monitoring::host: 'test.mirabeta.org'

mediawiki::multiversion::versions:
  '1.45':
    branch: 'REL1_45'
    default: true

role::mediawiki::php::restarts::ensure: present
role::mediawiki::php::restarts::opcache_limit: 200

php::php_version: '8.4'

http_proxy: 'http://bastion.fsslc.wtnet:8080'

base::syslog::rsyslog_udp_localhost: true

prometheus::exporter::redis::collect_jobqueue_stats: present

# NGINX
nginx::keepalive_timeout: 65
nginx::keepalive_requests: 1000
nginx::logrotate_number: 2
nginx::use_graylog: true
nginx::remove_apache: false

httpd::remove_default_ports: true

# memcached
role::memcached::threads: ~
role::memcached::version: 'present'
role::memcached::growth_factor: 1.15
role::memcached::min_slab_size: 48
role::memcached::max_seq_reqs: 200
role::memcached::size: 1024
role::memcached::extended_options:
  - "modern"
role::memcached::port: 11211

role::mediawiki::mcrouter::shards:
  wikitide:
    shard01:
      host: 10.0.15.118

role::mediawiki::use_mcrouter: true
